---
- name: Adjusting limits
  pam_limits:
    domain: "{{ hive_user }}"
    limit_item: nproc
    limit_type: "{{ item.type }}"
    value: "{{ item.value }}"
  with_items:
    - { type: 'soft', value: 128 }
    - { type: 'hard', value: 1024 }

- name: Install Hive packages
  yum:
    name: hive-hcatalog
    update_cache: yes
    state: latest

- name: Copy environment file to profile
  template:
    src: hive_env.sh.j2
    dest: /etc/profile.d/hive_env.sh
    owner: root
    group: root
    mode: 0644

- include_tasks: configure.yml

- include_tasks: setup-metastore.yml
